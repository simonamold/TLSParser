sample_alert = bytes.fromhex(
    "15 03 03 0002" # TLS record header: Alert TLS 1.2 , 2bytes
    "01" # Alert lvl Warning
    "28" # Alert Description= Handshake Failure (40/0x28)
)

sample_css = bytes.fromhex(
    "14 03 03 00 01" # TLS record header: Change Cipher Spec TLS 1.2 , 2bytes
    "01"
)

client_hellos = [
    (
    "16 03 01 00 31"
    "01 00 00 49" 
    "03 03"
    "53 43 5b 90 4b 90 95 6b 3f f2 1f 63 55 5d b0 3a"
    "13 66 8c 60 e8 ab 82 56 d0 36 4c 9b 41 0e 231c"
    "00"
    "00 04"
    "00 2f 00 35"
    "01"
    "00"
    "00 00"
    ),
    (
    "16 03 03 00 30"                  # TLS Record Header: ContentType=22 (Handshake), Version=1.2, Length=46
    "01 00 00 2c"                    # Handshake Header: Type=1 (ClientHello), Length=44
    "03 03"                          # ClientHello Version: TLS 1.2
    "00 01 02 03 04 05 06 07"        # Random (first 8 bytes shown)
    "08 09 0A 0B 0C 0D 0E 0F"
    "10 11 12 13 14 15 16 17"
    "18 19 1A 1B 1C 1D 1E 1F"
    "01"                             # Session ID Length
    "AA"                             # Session ID
    "00 04"                          # Cipher Suites Length: 4 bytes = 2 suites
    "00 2F 00 35"                    # Cipher Suites: TLS_RSA_WITH_AES_128_CBC_SHA, TLS_RSA_WITH_AES_256_CBC_SHA
    "01"                             # Compression Methods Length
    "00"                             # Compression Method: null
    ),
    (
    "16 03 05 00 2f "  # TLS record header: Handshake, TLS 1.0, 47 bytes
    "01 00 00 2b"     # Handshake message: ClientHello (0x01), length 43 bytes
    "03 03"           # ClientHello version: TLS 1.2
    "53 4c 4e 00 00 00 00 00 00 00 00 00 00 00 00 00"
    "00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00"  # Random
    "00"             # Session ID length: 0
    "00 02"          # Cipher Suites length: 2 bytes
    "00 3c"          # Cipher Suite: TLS_RSA_WITH_AES_128_CBC_SHA
    "01"             # Compression Methods Length: 1
    "00"             # Compression Method: null
    "00 00"
    )
]

server_hellos = [
    (
        "16 03 03 00 31 "
        "02 00 00 2d "
        "03 03 "
        "70 71 72 73 74 75 76 77 78 79 7a 7b 7c 7d 7e 7f "
        "80 81 82 83 84 85 86 87 88 89 8a 8b 8c 8d 8e 8f "
        "00 "
        "c0 13 "
        "00 "
        "00 05 "
        "ff 01 00 01 00"
    ),
    (
    "16"        # Content Type: Handshake
    "03 03"     # TLS Version: 1.2
    "00 41"     # Length: 43 bytes  am nevoie de 65 = 

    "02"        # Handshake Type: ServerHello
    "00 00 3d"  # Length: 38 bytes  61
    "03 03"     # ServerHello Version: TLS 1.2

    "11 22 33 44 55 66 77 88 99 aa bb cc dd ee ff 00"
    "10 20 30 40 50 60 70 80 90 a0 b0 c0 d0 e0 f0 00"  # Random (32 bytes)

    "01 00"        # Session ID Length: 0
    "00 2f"     # Cipher Suite: TLS_RSA_WITH_AES_128_CBC_SHA
    "00"        # Compression Method: null

    "00 14"
    "00 00"        # Extension Type: 0x0000 (SNI)
    "00 10"        # Extension Length: 16 bytes

    "00 0f"        # Server Name List Length: 15 bytes
    "00"           # Server Name Type: host_name
    "00 0c"        # Server Name Length: 12 bytes
    "65 78 61 6d 70 6c 65 2e 63 6f 6d"  # Server Name: "example.com"
    )
]

truncated = [
    ("16 03"),
    ("16 03 03 01 2c 0c 00 01 28 03 00 1d 20 9f d7 ad 6d cf f4 29 8d d3 f9 6d 5b 1b 2a f9 10 a0 53 5b 14 88 d7 f8 fa bb 34 9a 98 28 80 b6 15 04 01 01 00 04 02 b6 61 f7 c1 91 ee 59 be 45 37 66 39 bd c3 d4 bb 81 e1 15 ca 73 c8 34 8b 52 5b 0d 23 38 aa 14 46 67 ed 94 31 02 14 12 cd 9b 84 4c ba 29 93 4a aa cc e8 73 41 4e c1 1c b0 2e 27 2d 0a d8 1f 76 7d 33 07 67 21 f1 3b f3 60 20 cf 0b 1f d0 ec b0 78 de 11 28 be ba 09 49 eb ec e1 a1 f9 6e 20 9d c3 6e 4f ff d3 6b 67 3a 7d dc 15 97 ad 44 08 e4 85 c4 ad b2 c8 73 84 12 49 37 25 23 80 9e 43 12 d0 c7 b3 52 2e f9 83 ca c1 e0 39 35 ff 13 a8 e9 6b a6 81 a6 2e 40 d3 e7 0a 7f f3 58 66 d3 d9 99 3f 9e 26 a6 34 c8 1b 4e 71 38 0f cd d6"),
    ('16 03 01 00 dc'  # Record header: Handshake, TLS 1.0, length = 220 bytes
        '01 00 00 d8'      # Handshake: type=ClientHello, length=216
        '03 03'            # Version: TLS 1.2
        '5d b8 d7 0e b5 c2 c1 2a f9 4b 76 b3 a1 0e 6f b0'
        'f3 33 b1 6e 2f 3f 16 50 77 12 f0 1e f3 4f c3 0b'  # Random (32 bytes)
        '00'              # Session ID Length: 0
        '00 20'           # Cipher Suites length: 32 bytes (16 suites)
        'c0 2f c0 2b c0 0a c0 09 c0 13 c0 14 00 9c 00 9d'
        '00 2f 00 35 00 0a 01 00'  # Cipher suites (truncated)
        '01 00'           # Compression methods length + null
        '00 74'           # Extensions length: 116 bytes
        '00 00 00 0e 00 0c 00 00 09 6c 6f 63 61 6c 68 6f 73 74'
        # (extensions truncated for brevity)
        '00 00'
    )
]

# both from https://tls13.xargs.org/

sample_client_hello = bytes.fromhex(
    "16 03 01 00 f8" \
    "01 00 00 f4 03 " \
    "03 00 01 02 03 04 05 06 07 08 " \
    "09 0a 0b 0c 0d 0e 0f 10 11 12 13 14 15 16 " \
    "17 18 19 1a 1b 1c 1d 1e 1f 20 e0 e1 e2 e3 e4 e5 e6 e7 e8 e9 ea eb " \
    "ec ed ee ef f0 f1 f2 f3 f4 f5 f6 f7 f8 f9 fa fb fc fd fe ff 00 08 13 02 13 03 13 " \
    "01 00 ff 01 00 00 a3 00 00 00 18 00 16 00 00 13 65 78 61 6d 70 6c 65 2e 75 6c 66 68 65 69 6d 2e " \
    "6e 65 74 00 0b 00 04 03 00 01 02 00 0a 00 16 00 14 00 1d 00 17 00 1e 00 19 00 18 01 00 01 01 01 02 " \
    "01 03 01 04 00 23 00 00 00 16 00 00 00 17 00 00 00 0d 00 1e 00 1c 04 03 05 03 06 03 08 07 08 08 08 " \
    "09 08 0a 08 0b 08 04 08 05 08 06 04 01 05 01 06 01 00 2b 00 03 02 03 04 00 2d 00 02 01 01 00 33 00 " \
    "26 00 24 00 1d 00 20 35 80 72 d6 36 58 80 d1 ae ea 32 9a df 91 21 38 38 51 ed 21 a2 8e 3b 75 e9 65 " \
    "d0 d2 cd 16 62 54"
)

sample_server_hello = bytes.fromhex(
    "16 03 03 00 7a 02 00 00 76 03 03 70 71 72 73 74 75 " \
    "76 77 78 79 7a 7b 7c 7d 7e 7f 80 81 82 83 84 85 86 87 88 89 " \
    "8a 8b 8c 8d 8e 8f 20 e0 e1 e2 e3 e4 e5 e6 e7 e8 e9 ea eb ec ed ee ef f0 f1 f2 " \
    "f3 f4 f5 f6 f7 f8 f9 fa fb fc fd fe ff 13 02 00 00 2e 00 2b 00 02 03 04 00 33 00 24 00 1d 00 20 9f d7 ad " \
    "6d cf f4 29 8d d3 f9 6d 5b 1b 2a f9 10 a0 53 5b 14 88 d7 f8 fa bb 34 9a 98 28 80 b6 15"
    
)

wireshark_packets = [
    # client hello
    ("16030107180100071403036d697ac841b4ee8f8" \
"884843a14fc5413f80fd7f5490be5cb28c2e184a1c5c7d020bc7c2b3fc3d57b795512f30d12f24db52b0" \
"9fdf856d24f15b08db8af84eddced0020caca130113021303c02bc02fc02cc030cca9cca8c013c014009c" \
"009d002f0035010006ab2a2a0000002b0007063a3a03040303ff010001000005000501000000000023000" \
"044cd000500030268320010000e000c02683208687474702f312e31001b0003020002000a000c000a6a6a1" \
"1ec001d00170018000d001200100403080404010503080505010806060100000014001200000f617065782e" \
"6f7261636c652e636f6d003304ef04ed6a6a00010011ec04c0d85c00bada72320aa59ab72003bbbb06ca5d6" \
"173cc6c7883279c556fe9b4ac91bf35e66ad35590ef2176b74a323573a07e42ca13e94e7b823db1901ea7993" \
"291c4bcdde5066252834e65031aa9a572880ae9738c1d4067c05ac59300773476643cfc049e0a12113756192" \
"399a75a6e3619ad42e0b2149a77d1551cdaa30bdb1c89a0048975dcaf6b879f665370f3c7319f4271a265cc9" \
"510734b09c04b618e0c96cd805133d7208335b35f53c65470242315a38a32550cc4ac242b75573ca8a373d176f" \
"4635325f4a7186a9148d63e2d1230820050c2e1469ffc49320bad87d8c377f7187bb821626469bd2a587fd518d" \
"7c57349e58f4071078ae871fa1c805871a87fab5053c3059b969abab523d33206d4da5851f6a70d739e9395416da" \
"39effd07bd74901b950291b55cc3a347c406b58d547c587d62f5f327b52342bda676f572722a5b865df798292fa2" \
"94ebb483ff2c423f5142d51162822b4b93172a61b4440778569712b7dc74b6afa33e8458bad6912ef19463cc95741" \
"0a398208a349db84d8c750b9c4ac37ba3f54875c020978dac1c10adcb280922f8c5b4d57cc6dd1036a38591d91ab8a" \
"78f6008a0530c7c76c8d173c46a694af697cdf763d18572c99776a4440c8afe90fab928666e5046a2a921a313a750c" \
"9c48bc4ea860c6a9e251c1d941b712c7c0b5a4da9566440ab471053d9f14062c27939865498a75bc92538dddd4173f" \
"7b5c19e4783cfb70e745ac760b6867e72945e042fb096e3ca2547ecaa7f7b41feba1c94ff2041c34af9a08d06f3aaf" \
"7d654cf69450b6e4414a53ac2f749beb3c5c1d25b7f5b553e36061327c25093b1698aba71dea77fbbc9c7f49466b53c9" \
"376bc24f6b26e85a13c23a929998c1353b5c5926c033f372233a6263449483b5851457c867e7bc26617dbf5575ad346f2fab59c" \
"f0b21c51c786cc5366cf3ac167055ff27134f0b17ac18154aa6bde6340aa1003b74983525f2c1ae060c2a45190e0a87e24cb5f226" \
"9ce433171eba4a9cda4b34a5c5ca533e50bb7e69373df379a0fd3651054ba9153b3f36ab470b2709325891cad7083626b5a2448b28b" \
"3394f63b33a808cf0b0531b15024f042ed8b7c111323c377258aa75c13ae45937d627611c30e12b3cd48a332f17c0c320c9151214802" \
"49615f9685c252a12f50a4c890c243c80efc4b166cbbe0034317fdb59428c360dd78eeb533560e5b83994c99d994504e122ba2b78f72" \
"c1319d04124560f9072a2ca4b3957f90caa834ca4325f14dac9347493a7e731461a2d88e2c13e0034bea20a42c691ddaaa61ee2901c5" \
"557f9e0b239279ed2586bd3469e5205398ca5402aec072ff2564dc7ae5e9667aeaa4cbcf96bb8c8a3419041b7f641cee26d9f0bced784" \
"2cda7890b675386e543d5ae322bb53bb5606c3b8d44e6facc5b87b3f843c99dbf1882b43a89165861d3ba769735272a6175a858ee38a8" \
"1ae32173e3b538f1839c514919d6962263a7a8ad9800c2798cdea408c23165f1c8c59d782dcfa45d8857e1390b58540458713cd8d9a2e" \
"8ccbcfc472bb2e96213b06c281fc82afa76d04102a7b8a671b63afc35a98b9b22c59893a7047659f7609c6ab0206694fc5125ca13b4a8" \
"1593625afc57db06231534c6c1a767fd17876b7db9e7ac146b3f3f29a784565abc3744a78360bcec714475cdeb36b174fde0e5e00a866" \
"11ed78ddd8f1364f67001d0020529970babfbe868797b7529cc6ea7af39b264265f410f07f0457fbc86ba57b19fe0d011a0000010001a" \
"10020d7ab9c1847be9e4166c578cada94188dc391a95e99a8c69af12025266491332f00f0ae9c4eca218317b2c7cb4fcab828981b231c" \
"35615d0e8498d890c83e6de3d7c725d9f6a47ca3f53288ed7f0d24b67e491c8ecfd3e83ff8eead994889ed8373503bb1564a1b997a9d6" \
"5edd7ab240a88cef988f52df751b4214774486553848a51bbff0e7bf9c3e3f319df3aab801babdcf41e9e00e49c08855ab51eecea0bbf" \
"264191428576d65e5c249fa441b5dcb6e7534fec84704e918af08c4a40c7633e2d85321a9770b68b96107acfe1f0d4d636b35b1269c6f" \
"95173740edf4707dd8621a664525d7df9f6014bb66133a441e95d60fa129c47fef7ee1a28fc77c70bdf09a058cfbd54b9327dea0c6ea1" \
"8b9a59de00120000002d00020101000b0002010000170000aaaa000100"),
    # server_hello
    ("160303006c020000680303d4cb8b831096d177f635a2efd37eabdf7c5e258ef8266f173" \
"5562f768bcd63ce20382df3ccd94abd6e370c4d0d99a84f94ed2e38cbf29938fed689d88ccf931b8fc02f00002000000000000b00020100ff01000" \
"10000100005000302683200230000001700001603030ef80b000ef4000ef10005f0308205ec308204d4a00302010202100e2c7f5604e44c31ef11a1" \
"02dbdb00f0300d06092a864886f70d01010b0500303c310b3009060355040613025553310f300d060355040a1306416d617a6f6e311c301a0603550" \
"4031313416d617a6f6e205253412032303438204d3033301e170d3235303530313030303030305a170d3236303533313233353935395a302b312930" \
"2706035504031320657874656e73696f6e2e66656d6574726963732e6772616d6d61726c792e696f30820122300d06092a864886f70d01010105000" \
"382010f003082010a028201010098e21fb3c30bbce0b5be176f2634ceb7a5b7b7261cf4662435dad6204a16a4595c8e4e623a3bfc03d07f81ce65fc" \
"99376ffa5938f33e4ee4e44ac22644bc35749be87cbc6164709c75cf8cfb606531aaa546f9d36b651c07fa84d82596c639398db444c651cd40075b5" \
"395c57ad7e753f08fee5954b36567e97998a7f52bebd522315c8058272df2b017250829793f7828f892c6ce0fadd2d6066472e129f39610619adcc9" \
"437c13a6b41107caa2916e34b96403981cebb1b191f1ea035ab37dcf9964c952d84cf9de8b83c32ca662dd4da7aed533844f98d22313e15a750a591" \
"82bdb698275ddcc155db48a9c4ed265fc81758e063a6f64d900574823854daf0203010001a38202f9308202f5301f0603551d2304183016801455d9" \
"185fd21ccc01e158b4beabd9554201d72e02301d0603551d0e0416041486c06a8fd7e71ffdba187b906adc1afd568c5cd2302b0603551d110424302" \
"28220657874656e73696f6e2e66656d6574726963732e6772616d6d61726c792e696f30130603551d20040c300a3008060667810c010201300e0603" \
"551d0f0101ff0404030205a0301d0603551d250416301406082b0601050507030106082b06010505070302303b0603551d1f043430323030a02ea02" \
"c862a687474703a2f2f63726c2e72326d30332e616d617a6f6e74727573742e636f6d2f72326d30332e63726c307506082b06010505070101046930" \
"67302d06082b060105050730018621687474703a2f2f6f6373702e72326d30332e616d617a6f6e74727573742e636f6d303606082b0601050507300" \
"2862a687474703a2f2f6372742e72326d30332e616d617a6f6e74727573742e636f6d2f72326d30332e636572300c0603551d130101ff0402300030" \
"82017e060a2b06010401d6790204020482016e0482016a0168007600969764bf555897adf743876837084277e9f03ad5f6a4f3366e46a43f0fcaa9c" \
"60000019689b2b6610000040300473045022100d42c9c6962915feb78380dca1b935caee421957cdb8c6a32ed0cbdba7544951802200540a8907e36" \
"f99e21e7c1d79cce0d9377efe049ae8d0cf2e84cb5c51d5f3e7e0076006411c46ca412eca7891ca2022e00bcab4f2807d41e3527abeafed503c97dc" \
"df00000019689b2b6690000040300473045022051ab9804081c9e98c07f36f2860cbcecba99799a25c7d2c763c31fc34a693c37022100d5a3058325" \
"42ef4c6bef296be9929b5e7bb4b12b05aa8d7f78b84ed6a48f308a007600499c9b69de1d7cecfc36decd8764a6b85baf0a878019d15552fbe9eb29d" \
"df8c30000019689b2b67a0000040300473045022066685eb9d89f91ba3ea46e0934fb6262c415a29b93110d4e67260d1230bda138022100b6d5e199" \
"87d6f7045919b64aaf8e8def2d68875a3881a21fd43a873dfada81de300d06092a864886f70d01010b05000382010100210fc735177ca72ef5c43e7" \
"02422569a87356f145e51d83732bf3af5dea7c82b21c728c650570dd566b24cbb95cb852139e88bad6c5a81eee68470c31e861ce9dc56d6de68f32a" \
"811ddc2f5a058e4f526a0ab7be8280e82fc3d3072ef2e8e0ecf04954e5404115bc2b349c16e5bfc5bbe82368449e96761cf144c8ef90f1fc2a0bfda" \
"c2f7c3a6133ba57d0da9704cc53f5523a7744aa98bc5aa7dbe5e50ad3959e5589ebe9e0bf8ad4f96349114fd06901e889eb896bef0623ebe3851ce8" \
"c7fbd4825e05a0ed91c44346d9bfc85adeb580aa109c3bba45be1873efa5c69a6294b69dd38ed0daf4fb994e2607ac8e1542c9fac282e6213b6940e" \
"5022b8eaf86890004623082045e30820346a00302010202130773124cd406d267c0991cdd299a9f38317985300d06092a864886f70d01010b050030" \
"39310b3009060355040613025553310f300d060355040a1306416d617a6f6e3119301706035504031310416d617a6f6e20526f6f742043412031301" \
"e170d3232303832333232323630345a170d3330303832333232323630345a303c310b3009060355040613025553310f300d060355040a1306416d61" \
"7a6f6e311c301a06035504031313416d617a6f6e205253412032303438204d303330820122300d06092a864886f70d01010105000382010f0030820" \
"10a0282010100b77fa55928f2fb8ce3be537f8e4757705b0a5fc1f49cbcf46d4246416370f634e9603d952fbb7566d403b1ad5942a892cafaf6128c" \
"c1c32c369c65c3b6f78de5c5831074f7f9e66a57005ad9cbcc5f8b6832840390d09af2b3ba1d677c87ea1222824129975e1d3d5ecf9d3bb726e6a6d" \
"a2f686134909201e8dc8b072f38580536010c478db09ba288147b105b6f23840fb5bbf334a7a7d5c117ae12065f2df771f363f1d0b25c9379524f71" \
"01fc97db76c74ecf3ce0e58918d5d7eea9ff32e5f51e67b0b35976d38ee8f05ff4e8be6796280dfa54b0b3ef96b35bab4336e0e7eba14ea400d967d" \
"a2655a17a06a34988b31597a3f7fdcd0e894302e99e4e7ca70203010001a382015a3082015630120603551d130101ff040830060101ff020100300e" \
"0603551d0f0101ff040403020186301d0603551d250416301406082b0601050507030106082b06010505070302301d0603551d0e0416041455d9185" \
"fd21ccc01e158b4beabd9554201d72e02301f0603551d230418301680148418cc8534ecbc0c94942e08599cc7b2104e0a08307b06082b0601050507" \
"0101046f306d302f06082b060105050730018623687474703a2f2f6f6373702e726f6f746361312e616d617a6f6e74727573742e636f6d303a06082" \
"b06010505073002862e687474703a2f2f6372742e726f6f746361312e616d617a6f6e74727573742e636f6d2f726f6f746361312e636572303f0603" \
"551d1f043830363034a032a030862e687474703a2f2f63726c2e726f6f746361312e616d617a6f6e74727573742e636f6d2f726f6f746361312e637" \
"26c30130603551d20040c300a3008060667810c010201300d06092a864886f70d01010b05000382010100068de5a6d9c0bedf3d8ccd20a7b5ee3aff" \
"b259be3de24190d8ec4bce0cd759178d67ef52eb93d91b7cdc1eacad1d54dcd6dfa59e7ebee3ed94b0055839d16e5acbae6335237be134d0575cade" \
"169d26d5bcde8a94cb35862c8e65da072ac2835765063716dda0160240d6b619817c1502162ee80da77e5a48ea4ccba705972985428988ae73901f0" \
"2b59ef558e2ac43489314fe0349cf5ec3f00acf3779e09f26764f07a9274b8120dcf71b9b5edab745505e22e18dc16fb1549470d89b8bbc688446a6" \
"4d99a5f5e6c5aa319db201651bc62cf494b8fc27c2850e32c27c8e2ac8e6fb3676f7213dbeccb48d6b95e8b4d9fda2bc7dafc648c32e5b52a5ed9f8" \
"82000496308204923082037aa0030201020213067f944a2a27cdf3fac2ae2b01f908eeb9c4c6300d06092a864886f70d01010b0500308198310b300" \
"90603550406130255533110300e060355040813074172697a6f6e61311330110603550407130a53636f74747364616c65")
]


